{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sinajp\\\\OneDrive - SAS\\\\Documents\\\\GitHub\\\\ajay17m.github.io-1\\\\viya_app\\\\src\\\\pages\\\\Compute.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Instance from '../apis/Instance';\nimport { AuthContext } from '../contexts';\nimport Container from 'react-bootstrap/Container';\nimport ComputeSelector from '../components/Selectors/ComputeSelector';\nimport TableViewer from '../components/TableViewer/TableViewer';\nimport Loading from '../components/Loading';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Compute() {\n  _s();\n\n  const {\n    authInfo,\n    setAuthInfo\n  } = useContext(AuthContext);\n  const [selection, setSelection] = useState({\n    library: null,\n    table: null\n  });\n  const [tableData, setTableData] = useState({\n    rows: [],\n    columns: []\n  });\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n  useEffect(() => {\n    if (authInfo.authenticated === false) {\n      history.push(\"/logon\");\n    }\n  }, [authInfo.authenticated, history]);\n  useEffect(() => {\n    if (authInfo.authenticated === true && !(\"compute\" in authInfo.session)) {\n      const endpoint = '/compute/contexts';\n      const headers = {\n        'Accept': 'application/vnd.sas.collection+json',\n        'Accept-Item': 'application/vnd.sas.compute.context+json'\n      };\n      Instance.get(endpoint, {\n        headers: headers\n      }).then(response => {\n        const [context] = response.data.items.filter(element => element.name.includes(\"SAS Studio\") ? element : null);\n        const [link] = context.links.filter(element => element.rel === \"createSession\" ? element : null);\n        const headers = {\n          'Accept': link.responseType + '+json',\n          'Content-Type': link.type + '+json'\n        };\n        Instance(link.href, {\n          method: link.method,\n          headers: headers\n        }).then(response => {\n          setAuthInfo({ ...authInfo,\n            session: { ...authInfo.session,\n              compute: response.data.id\n            }\n          });\n        });\n      });\n    }\n  }, [authInfo, setAuthInfo]);\n  useEffect(() => {\n    if (authInfo.session.compute !== \"\" && selection.table !== null) {\n      const endpoint = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}`;\n      const headers = {\n        \"Accept\": \"application/vnd.sas.compute.data.table+json\"\n      };\n      Instance.get(endpoint, {\n        headers: headers\n      }).then(response => {\n        const rowCount = response.data.rowCount;\n        const columnCount = response.data.columnCount;\n        const headers = {\n          \"Accept\": \"application/vnd.sas.collection+json\"\n        };\n        const endpointRows = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/rows?limit=${rowCount}`;\n        const endpointColumns = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/columns?limit=${columnCount}`;\n        axios.all([Instance.get(endpointRows, {\n          headers: headers\n        }), Instance.get(endpointColumns, {\n          headers: headers\n        })]).then(axios.spread((rows, columns) => {\n          if (rows.data.items.length > 0 && columns.data.items.length > 0) {\n            const columnsData = columns.data.items.map(item => ({\n              name: item.name,\n              label: item.label\n            }));\n            const rowsData = rows.data.items.map(item => item.cells);\n            setTableData({\n              rows: rowsData,\n              columns: columnsData\n            });\n          }\n        }));\n      });\n    }\n\n    ;\n  }, [selection, authInfo.session]);\n\n  const handleSelection = event => {\n    event.preventDefault();\n    setTableData({\n      rows: [],\n      columns: []\n    });\n    setLoading(true);\n    const selection = {\n      library: event.target[0].value,\n      table: event.target[1].value\n    };\n    setSelection(selection);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"justify-content-md-center\",\n    children: [/*#__PURE__*/_jsxDEV(ComputeSelector, {\n      onSelect: handleSelection\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this), tableData.rows.length !== tableData.columns.length ? /*#__PURE__*/_jsxDEV(TableViewer, {\n      data: tableData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 67\n    }, this) : /*#__PURE__*/_jsxDEV(Loading, {\n      status: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 102\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Compute, \"c8CyaugmTAw6CrR/rTha96PIeTc=\", false, function () {\n  return [useHistory];\n});\n\n_c = Compute;\nexport default Compute;\n\nvar _c;\n\n$RefreshReg$(_c, \"Compute\");","map":{"version":3,"names":["useEffect","useState","useContext","useHistory","Instance","AuthContext","Container","ComputeSelector","TableViewer","Loading","axios","Compute","authInfo","setAuthInfo","selection","setSelection","library","table","tableData","setTableData","rows","columns","loading","setLoading","history","authenticated","push","session","endpoint","headers","get","then","response","context","data","items","filter","element","name","includes","link","links","rel","responseType","type","href","method","compute","id","rowCount","columnCount","endpointRows","endpointColumns","all","spread","length","columnsData","map","item","label","rowsData","cells","handleSelection","event","preventDefault","target","value"],"sources":["C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/src/pages/Compute.js"],"sourcesContent":["import { useEffect, useState, useContext } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nimport Instance from '../apis/Instance';\r\n\r\nimport { AuthContext } from '../contexts';\r\n\r\nimport Container from 'react-bootstrap/Container';\r\n\r\nimport ComputeSelector from '../components/Selectors/ComputeSelector';\r\nimport TableViewer from '../components/TableViewer/TableViewer';\r\nimport Loading from '../components/Loading';\r\nimport axios from 'axios';\r\n\r\nfunction Compute() {\r\n    const { authInfo, setAuthInfo } = useContext(AuthContext);\r\n    const [selection, setSelection] = useState({ library: null, table: null });\r\n    const [tableData, setTableData] = useState({ rows: [], columns: [] });\r\n    const [loading, setLoading] = useState(false);\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === false) {\r\n            history.push(\"/logon\");\r\n        }\r\n    }, [authInfo.authenticated, history]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === true && !(\"compute\" in authInfo.session)) {\r\n            const endpoint = '/compute/contexts';\r\n            const headers = {\r\n                'Accept': 'application/vnd.sas.collection+json',\r\n                'Accept-Item': 'application/vnd.sas.compute.context+json'\r\n            };\r\n            Instance.get(endpoint, { headers: headers })\r\n                .then(response => {\r\n                    const [context] = response.data.items.filter(element => element.name.includes(\"SAS Studio\") ? element : null);\r\n                    const [link] = context.links.filter(element => element.rel === \"createSession\" ? element : null);\r\n                    const headers = {\r\n                        'Accept': link.responseType + '+json',\r\n                        'Content-Type': link.type + '+json'\r\n                    };\r\n                    Instance(link.href, { method: link.method, headers: headers })\r\n                        .then(response => {\r\n                            setAuthInfo({ ...authInfo, session: { ...authInfo.session, compute: response.data.id } });\r\n                        });\r\n                });\r\n        }\r\n    }, [authInfo, setAuthInfo]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.session.compute !== \"\" && selection.table !== null) {\r\n            const endpoint = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}`;\r\n            const headers = {\r\n                \"Accept\": \"application/vnd.sas.compute.data.table+json\"\r\n            };\r\n            Instance.get(endpoint, { headers: headers })\r\n                .then(response => {\r\n                    const rowCount = response.data.rowCount;\r\n                    const columnCount = response.data.columnCount;\r\n                    const headers = {\r\n                        \"Accept\": \"application/vnd.sas.collection+json\"\r\n                    };\r\n                    const endpointRows = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/rows?limit=${rowCount}`;\r\n                    const endpointColumns = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/columns?limit=${columnCount}`;\r\n                    axios.all([\r\n                        Instance.get(endpointRows, { headers: headers }),\r\n                        Instance.get(endpointColumns, { headers: headers })\r\n                    ]).then(axios.spread((rows, columns) => {\r\n                        if (rows.data.items.length > 0 && columns.data.items.length > 0) {\r\n                            const columnsData = columns.data.items.map(item => ({ name: item.name, label: item.label }));\r\n                            const rowsData = rows.data.items.map(item => (item.cells));\r\n                            setTableData({ rows: rowsData, columns: columnsData });\r\n                        }\r\n                    }));\r\n                });\r\n        };\r\n    }, [selection, authInfo.session]);\r\n\r\n    const handleSelection = (event) => {\r\n        event.preventDefault();\r\n        setTableData({ rows: [], columns: [] });\r\n        setLoading(true);\r\n        const selection = { library: event.target[0].value, table: event.target[1].value };\r\n        setSelection(selection);\r\n    };\r\n\r\n    return (\r\n        <Container className=\"justify-content-md-center\">\r\n            <ComputeSelector onSelect={handleSelection} />\r\n            {tableData.rows.length !== tableData.columns.length ? <TableViewer data={tableData} /> : <Loading status={loading} />}\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Compute;"],"mappings":"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"},"metadata":{},"sourceType":"module"}