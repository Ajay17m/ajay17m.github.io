{"ast":null,"code":"import _objectSpread from\"C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,useContext}from'react';import{useHistory}from'react-router-dom';import Instance from'../apis/Instance';import{AuthContext}from'../contexts';import Container from'react-bootstrap/Container';import ComputeSelector from'../components/Selectors/ComputeSelector';import TableViewer from'../components/TableViewer/TableViewer';import Loading from'../components/Loading';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Compute(){var _useContext=useContext(AuthContext),authInfo=_useContext.authInfo,setAuthInfo=_useContext.setAuthInfo;var _useState=useState({library:null,table:null}),_useState2=_slicedToArray(_useState,2),selection=_useState2[0],setSelection=_useState2[1];var _useState3=useState({rows:[],columns:[]}),_useState4=_slicedToArray(_useState3,2),tableData=_useState4[0],setTableData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var history=useHistory();useEffect(function(){if(authInfo.authenticated===false){history.push(\"/logon\");}},[authInfo.authenticated,history]);useEffect(function(){if(authInfo.authenticated===true&&!(\"compute\"in authInfo.session)){var endpoint='/compute/contexts';var headers={'Accept':'application/vnd.sas.collection+json','Accept-Item':'application/vnd.sas.compute.context+json'};Instance.get(endpoint,{headers:headers}).then(function(response){var _response$data$items$=response.data.items.filter(function(element){return element.name.includes(\"SAS Studio\")?element:null;}),_response$data$items$2=_slicedToArray(_response$data$items$,1),context=_response$data$items$2[0];var _context$links$filter=context.links.filter(function(element){return element.rel===\"createSession\"?element:null;}),_context$links$filter2=_slicedToArray(_context$links$filter,1),link=_context$links$filter2[0];var headers={'Accept':link.responseType+'+json','Content-Type':link.type+'+json'};Instance(link.href,{method:link.method,headers:headers}).then(function(response){setAuthInfo(_objectSpread(_objectSpread({},authInfo),{},{session:_objectSpread(_objectSpread({},authInfo.session),{},{compute:response.data.id})}));});});}},[authInfo,setAuthInfo]);useEffect(function(){if(authInfo.session.compute!==\"\"&&selection.table!==null){var endpoint=\"/compute/sessions/\".concat(authInfo.session.compute,\"/data/\").concat(selection.library,\"/\").concat(selection.table);var headers={\"Accept\":\"application/vnd.sas.compute.data.table+json\"};Instance.get(endpoint,{headers:headers}).then(function(response){var rowCount=response.data.rowCount;var columnCount=response.data.columnCount;var headers={\"Accept\":\"application/vnd.sas.collection+json\"};var endpointRows=\"/compute/sessions/\".concat(authInfo.session.compute,\"/data/\").concat(selection.library,\"/\").concat(selection.table,\"/rows?limit=\").concat(rowCount);var endpointColumns=\"/compute/sessions/\".concat(authInfo.session.compute,\"/data/\").concat(selection.library,\"/\").concat(selection.table,\"/columns?limit=\").concat(columnCount);axios.all([Instance.get(endpointRows,{headers:headers}),Instance.get(endpointColumns,{headers:headers})]).then(axios.spread(function(rows,columns){if(rows.data.items.length>0&&columns.data.items.length>0){var columnsData=columns.data.items.map(function(item){return{name:item.name,label:item.label};});var rowsData=rows.data.items.map(function(item){return item.cells;});setTableData({rows:rowsData,columns:columnsData});}}));});};},[selection,authInfo.session]);var handleSelection=function handleSelection(event){event.preventDefault();setTableData({rows:[],columns:[]});setLoading(true);var selection={library:event.target[0].value,table:event.target[1].value};setSelection(selection);};return/*#__PURE__*/_jsxs(Container,{className:\"justify-content-md-center\",children:[/*#__PURE__*/_jsx(ComputeSelector,{onSelect:handleSelection}),tableData.rows.length!==tableData.columns.length?/*#__PURE__*/_jsx(TableViewer,{data:tableData}):/*#__PURE__*/_jsx(Loading,{status:loading})]});}export default Compute;","map":{"version":3,"names":["useEffect","useState","useContext","useHistory","Instance","AuthContext","Container","ComputeSelector","TableViewer","Loading","axios","Compute","authInfo","setAuthInfo","library","table","selection","setSelection","rows","columns","tableData","setTableData","loading","setLoading","history","authenticated","push","session","endpoint","headers","get","then","response","data","items","filter","element","name","includes","context","links","rel","link","responseType","type","href","method","compute","id","rowCount","columnCount","endpointRows","endpointColumns","all","spread","length","columnsData","map","item","label","rowsData","cells","handleSelection","event","preventDefault","target","value"],"sources":["C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/src/pages/Compute.js"],"sourcesContent":["import { useEffect, useState, useContext } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nimport Instance from '../apis/Instance';\r\n\r\nimport { AuthContext } from '../contexts';\r\n\r\nimport Container from 'react-bootstrap/Container';\r\n\r\nimport ComputeSelector from '../components/Selectors/ComputeSelector';\r\nimport TableViewer from '../components/TableViewer/TableViewer';\r\nimport Loading from '../components/Loading';\r\nimport axios from 'axios';\r\n\r\nfunction Compute() {\r\n    const { authInfo, setAuthInfo } = useContext(AuthContext);\r\n    const [selection, setSelection] = useState({ library: null, table: null });\r\n    const [tableData, setTableData] = useState({ rows: [], columns: [] });\r\n    const [loading, setLoading] = useState(false);\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === false) {\r\n            history.push(\"/logon\");\r\n        }\r\n    }, [authInfo.authenticated, history]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === true && !(\"compute\" in authInfo.session)) {\r\n            const endpoint = '/compute/contexts';\r\n            const headers = {\r\n                'Accept': 'application/vnd.sas.collection+json',\r\n                'Accept-Item': 'application/vnd.sas.compute.context+json'\r\n            };\r\n            Instance.get(endpoint, { headers: headers })\r\n                .then(response => {\r\n                    const [context] = response.data.items.filter(element => element.name.includes(\"SAS Studio\") ? element : null);\r\n                    const [link] = context.links.filter(element => element.rel === \"createSession\" ? element : null);\r\n                    const headers = {\r\n                        'Accept': link.responseType + '+json',\r\n                        'Content-Type': link.type + '+json'\r\n                    };\r\n                    Instance(link.href, { method: link.method, headers: headers })\r\n                        .then(response => {\r\n                            setAuthInfo({ ...authInfo, session: { ...authInfo.session, compute: response.data.id } });\r\n                        });\r\n                });\r\n        }\r\n    }, [authInfo, setAuthInfo]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.session.compute !== \"\" && selection.table !== null) {\r\n            const endpoint = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}`;\r\n            const headers = {\r\n                \"Accept\": \"application/vnd.sas.compute.data.table+json\"\r\n            };\r\n            Instance.get(endpoint, { headers: headers })\r\n                .then(response => {\r\n                    const rowCount = response.data.rowCount;\r\n                    const columnCount = response.data.columnCount;\r\n                    const headers = {\r\n                        \"Accept\": \"application/vnd.sas.collection+json\"\r\n                    };\r\n                    const endpointRows = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/rows?limit=${rowCount}`;\r\n                    const endpointColumns = `/compute/sessions/${authInfo.session.compute}/data/${selection.library}/${selection.table}/columns?limit=${columnCount}`;\r\n                    axios.all([\r\n                        Instance.get(endpointRows, { headers: headers }),\r\n                        Instance.get(endpointColumns, { headers: headers })\r\n                    ]).then(axios.spread((rows, columns) => {\r\n                        if (rows.data.items.length > 0 && columns.data.items.length > 0) {\r\n                            const columnsData = columns.data.items.map(item => ({ name: item.name, label: item.label }));\r\n                            const rowsData = rows.data.items.map(item => (item.cells));\r\n                            setTableData({ rows: rowsData, columns: columnsData });\r\n                        }\r\n                    }));\r\n                });\r\n        };\r\n    }, [selection, authInfo.session]);\r\n\r\n    const handleSelection = (event) => {\r\n        event.preventDefault();\r\n        setTableData({ rows: [], columns: [] });\r\n        setLoading(true);\r\n        const selection = { library: event.target[0].value, table: event.target[1].value };\r\n        setSelection(selection);\r\n    };\r\n\r\n    return (\r\n        <Container className=\"justify-content-md-center\">\r\n            <ComputeSelector onSelect={handleSelection} />\r\n            {tableData.rows.length !== tableData.columns.length ? <TableViewer data={tableData} /> : <Loading status={loading} />}\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Compute;"],"mappings":"mUAAA,OAASA,SAAT,CAAoBC,QAApB,CAA8BC,UAA9B,KAAgD,OAAhD,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,MAAOC,SAAP,KAAqB,kBAArB,CAEA,OAASC,WAAT,KAA4B,aAA5B,CAEA,MAAOC,UAAP,KAAsB,2BAAtB,CAEA,MAAOC,gBAAP,KAA4B,yCAA5B,CACA,MAAOC,YAAP,KAAwB,uCAAxB,CACA,MAAOC,QAAP,KAAoB,uBAApB,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,wFAEA,QAASC,QAAT,EAAmB,CACf,gBAAkCT,UAAU,CAACG,WAAD,CAA5C,CAAQO,QAAR,aAAQA,QAAR,CAAkBC,WAAlB,aAAkBA,WAAlB,CACA,cAAkCZ,QAAQ,CAAC,CAAEa,OAAO,CAAE,IAAX,CAAiBC,KAAK,CAAE,IAAxB,CAAD,CAA1C,wCAAOC,SAAP,eAAkBC,YAAlB,eACA,eAAkChB,QAAQ,CAAC,CAAEiB,IAAI,CAAE,EAAR,CAAYC,OAAO,CAAE,EAArB,CAAD,CAA1C,yCAAOC,SAAP,eAAkBC,YAAlB,eACA,eAA8BpB,QAAQ,CAAC,KAAD,CAAtC,yCAAOqB,OAAP,eAAgBC,UAAhB,eACA,GAAMC,QAAO,CAAGrB,UAAU,EAA1B,CAEAH,SAAS,CAAC,UAAM,CACZ,GAAIY,QAAQ,CAACa,aAAT,GAA2B,KAA/B,CAAsC,CAClCD,OAAO,CAACE,IAAR,CAAa,QAAb,EACH,CACJ,CAJQ,CAIN,CAACd,QAAQ,CAACa,aAAV,CAAyBD,OAAzB,CAJM,CAAT,CAMAxB,SAAS,CAAC,UAAM,CACZ,GAAIY,QAAQ,CAACa,aAAT,GAA2B,IAA3B,EAAmC,EAAE,WAAab,SAAQ,CAACe,OAAxB,CAAvC,CAAyE,CACrE,GAAMC,SAAQ,CAAG,mBAAjB,CACA,GAAMC,QAAO,CAAG,CACZ,SAAU,qCADE,CAEZ,cAAe,0CAFH,CAAhB,CAIAzB,QAAQ,CAAC0B,GAAT,CAAaF,QAAb,CAAuB,CAAEC,OAAO,CAAEA,OAAX,CAAvB,EACKE,IADL,CACU,SAAAC,QAAQ,CAAI,CACd,0BAAkBA,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA2B,SAAAC,OAAO,QAAIA,QAAO,CAACC,IAAR,CAAaC,QAAb,CAAsB,YAAtB,EAAsCF,OAAtC,CAAgD,IAApD,EAAlC,CAAlB,gEAAOG,OAAP,2BACA,0BAAeA,OAAO,CAACC,KAAR,CAAcL,MAAd,CAAqB,SAAAC,OAAO,QAAIA,QAAO,CAACK,GAAR,GAAgB,eAAhB,CAAkCL,OAAlC,CAA4C,IAAhD,EAA5B,CAAf,gEAAOM,IAAP,2BACA,GAAMb,QAAO,CAAG,CACZ,SAAUa,IAAI,CAACC,YAAL,CAAoB,OADlB,CAEZ,eAAgBD,IAAI,CAACE,IAAL,CAAY,OAFhB,CAAhB,CAIAxC,QAAQ,CAACsC,IAAI,CAACG,IAAN,CAAY,CAAEC,MAAM,CAAEJ,IAAI,CAACI,MAAf,CAAuBjB,OAAO,CAAEA,OAAhC,CAAZ,CAAR,CACKE,IADL,CACU,SAAAC,QAAQ,CAAI,CACdnB,WAAW,gCAAMD,QAAN,MAAgBe,OAAO,gCAAOf,QAAQ,CAACe,OAAhB,MAAyBoB,OAAO,CAAEf,QAAQ,CAACC,IAAT,CAAce,EAAhD,EAAvB,GAAX,CACH,CAHL,EAIH,CAZL,EAaH,CACJ,CArBQ,CAqBN,CAACpC,QAAD,CAAWC,WAAX,CArBM,CAAT,CAuBAb,SAAS,CAAC,UAAM,CACZ,GAAIY,QAAQ,CAACe,OAAT,CAAiBoB,OAAjB,GAA6B,EAA7B,EAAmC/B,SAAS,CAACD,KAAV,GAAoB,IAA3D,CAAiE,CAC7D,GAAMa,SAAQ,6BAAwBhB,QAAQ,CAACe,OAAT,CAAiBoB,OAAzC,kBAAyD/B,SAAS,CAACF,OAAnE,aAA8EE,SAAS,CAACD,KAAxF,CAAd,CACA,GAAMc,QAAO,CAAG,CACZ,SAAU,6CADE,CAAhB,CAGAzB,QAAQ,CAAC0B,GAAT,CAAaF,QAAb,CAAuB,CAAEC,OAAO,CAAEA,OAAX,CAAvB,EACKE,IADL,CACU,SAAAC,QAAQ,CAAI,CACd,GAAMiB,SAAQ,CAAGjB,QAAQ,CAACC,IAAT,CAAcgB,QAA/B,CACA,GAAMC,YAAW,CAAGlB,QAAQ,CAACC,IAAT,CAAciB,WAAlC,CACA,GAAMrB,QAAO,CAAG,CACZ,SAAU,qCADE,CAAhB,CAGA,GAAMsB,aAAY,6BAAwBvC,QAAQ,CAACe,OAAT,CAAiBoB,OAAzC,kBAAyD/B,SAAS,CAACF,OAAnE,aAA8EE,SAAS,CAACD,KAAxF,wBAA4GkC,QAA5G,CAAlB,CACA,GAAMG,gBAAe,6BAAwBxC,QAAQ,CAACe,OAAT,CAAiBoB,OAAzC,kBAAyD/B,SAAS,CAACF,OAAnE,aAA8EE,SAAS,CAACD,KAAxF,2BAA+GmC,WAA/G,CAArB,CACAxC,KAAK,CAAC2C,GAAN,CAAU,CACNjD,QAAQ,CAAC0B,GAAT,CAAaqB,YAAb,CAA2B,CAAEtB,OAAO,CAAEA,OAAX,CAA3B,CADM,CAENzB,QAAQ,CAAC0B,GAAT,CAAasB,eAAb,CAA8B,CAAEvB,OAAO,CAAEA,OAAX,CAA9B,CAFM,CAAV,EAGGE,IAHH,CAGQrB,KAAK,CAAC4C,MAAN,CAAa,SAACpC,IAAD,CAAOC,OAAP,CAAmB,CACpC,GAAID,IAAI,CAACe,IAAL,CAAUC,KAAV,CAAgBqB,MAAhB,CAAyB,CAAzB,EAA8BpC,OAAO,CAACc,IAAR,CAAaC,KAAb,CAAmBqB,MAAnB,CAA4B,CAA9D,CAAiE,CAC7D,GAAMC,YAAW,CAAGrC,OAAO,CAACc,IAAR,CAAaC,KAAb,CAAmBuB,GAAnB,CAAuB,SAAAC,IAAI,QAAK,CAAErB,IAAI,CAAEqB,IAAI,CAACrB,IAAb,CAAmBsB,KAAK,CAAED,IAAI,CAACC,KAA/B,CAAL,EAA3B,CAApB,CACA,GAAMC,SAAQ,CAAG1C,IAAI,CAACe,IAAL,CAAUC,KAAV,CAAgBuB,GAAhB,CAAoB,SAAAC,IAAI,QAAKA,KAAI,CAACG,KAAV,EAAxB,CAAjB,CACAxC,YAAY,CAAC,CAAEH,IAAI,CAAE0C,QAAR,CAAkBzC,OAAO,CAAEqC,WAA3B,CAAD,CAAZ,CACH,CACJ,CANO,CAHR,EAUH,CAnBL,EAoBH,EACJ,CA3BQ,CA2BN,CAACxC,SAAD,CAAYJ,QAAQ,CAACe,OAArB,CA3BM,CAAT,CA6BA,GAAMmC,gBAAe,CAAG,QAAlBA,gBAAkB,CAACC,KAAD,CAAW,CAC/BA,KAAK,CAACC,cAAN,GACA3C,YAAY,CAAC,CAAEH,IAAI,CAAE,EAAR,CAAYC,OAAO,CAAE,EAArB,CAAD,CAAZ,CACAI,UAAU,CAAC,IAAD,CAAV,CACA,GAAMP,UAAS,CAAG,CAAEF,OAAO,CAAEiD,KAAK,CAACE,MAAN,CAAa,CAAb,EAAgBC,KAA3B,CAAkCnD,KAAK,CAAEgD,KAAK,CAACE,MAAN,CAAa,CAAb,EAAgBC,KAAzD,CAAlB,CACAjD,YAAY,CAACD,SAAD,CAAZ,CACH,CAND,CAQA,mBACI,MAAC,SAAD,EAAW,SAAS,CAAC,2BAArB,wBACI,KAAC,eAAD,EAAiB,QAAQ,CAAE8C,eAA3B,EADJ,CAEK1C,SAAS,CAACF,IAAV,CAAeqC,MAAf,GAA0BnC,SAAS,CAACD,OAAV,CAAkBoC,MAA5C,cAAqD,KAAC,WAAD,EAAa,IAAI,CAAEnC,SAAnB,EAArD,cAAwF,KAAC,OAAD,EAAS,MAAM,CAAEE,OAAjB,EAF7F,GADJ,CAMH,CAED,cAAeX,QAAf"},"metadata":{},"sourceType":"module"}