{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sinajp\\\\OneDrive - SAS\\\\Documents\\\\GitHub\\\\ajay17m.github.io-1\\\\viya_app\\\\src\\\\pages\\\\Cas.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Instance from '../apis/Instance';\nimport { AuthContext } from '../contexts';\nimport Container from 'react-bootstrap/Container';\nimport CASSelector from '../components/Selectors/CASSelector';\nimport TableViewer from '../components/TableViewer/TableViewer';\nimport Loading from '../components/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CAS() {\n  _s();\n\n  const {\n    authInfo,\n    setAuthInfo\n  } = useContext(AuthContext);\n  const [selection, setSelection] = useState({\n    library: null,\n    table: null\n  });\n  const [tableData, setTableData] = useState({\n    rows: [],\n    columns: []\n  });\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n  useEffect(() => {\n    if (authInfo.authenticated === false) {\n      history.push(\"/logon\");\n    }\n  }, [authInfo.authenticated, history]);\n  useEffect(() => {\n    if (authInfo.authenticated === true && !(\"cas\" in authInfo.session)) {\n      const endpoint = '/cas-shared-default-http/cas/sessions';\n      Instance.post(endpoint).then(response => {\n        setAuthInfo({ ...authInfo,\n          session: { ...authInfo.session,\n            cas: response.data.session\n          }\n        });\n      });\n    }\n  }, [authInfo, setAuthInfo]);\n  useEffect(() => {\n    if (authInfo.session.cas !== \"\" && selection.table !== null) {\n      const endpoint = `/cas-shared-default-http/cas/sessions/${authInfo.session.cas}/actions/table.fetch`;\n      const data = {\n        \"table\": {\n          \"caslib\": selection.library,\n          \"name\": selection.table\n        }\n      };\n      const headers = {\n        \"accept\": \"application/json\",\n        \"content-type\": \"application/json\"\n      };\n      Instance.post(endpoint, data, {\n        headers: headers\n      }).then(response => {\n        if (response.data.results.Fetch.schema.length > 0) {\n          const result = response.data.results.Fetch;\n          setTableData({\n            rows: result.rows,\n            columns: result.schema\n          });\n        }\n      });\n    }\n  }, [selection, authInfo.session]);\n\n  const handleSelection = event => {\n    event.preventDefault();\n    setTableData({\n      rows: [],\n      columns: []\n    });\n    setLoading(true);\n    const selection = {\n      library: event.target[0].value,\n      table: event.target[1].value\n    };\n    setSelection(selection);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"justify-content-md-center\",\n    children: [/*#__PURE__*/_jsxDEV(CASSelector, {\n      onSelect: handleSelection\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this), tableData.rows.length !== tableData.columns.length ? /*#__PURE__*/_jsxDEV(TableViewer, {\n      data: tableData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 67\n    }, this) : /*#__PURE__*/_jsxDEV(Loading, {\n      status: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 102\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n}\n\n_s(CAS, \"c8CyaugmTAw6CrR/rTha96PIeTc=\", false, function () {\n  return [useHistory];\n});\n\n_c = CAS;\n;\nexport default CAS;\n\nvar _c;\n\n$RefreshReg$(_c, \"CAS\");","map":{"version":3,"names":["useEffect","useState","useContext","useHistory","Instance","AuthContext","Container","CASSelector","TableViewer","Loading","CAS","authInfo","setAuthInfo","selection","setSelection","library","table","tableData","setTableData","rows","columns","loading","setLoading","history","authenticated","push","session","endpoint","post","then","response","cas","data","headers","results","Fetch","schema","length","result","handleSelection","event","preventDefault","target","value"],"sources":["C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/src/pages/Cas.js"],"sourcesContent":["import { useEffect, useState, useContext } from 'react';\r\nimport { useHistory} from 'react-router-dom';\r\nimport Instance from '../apis/Instance';\r\n\r\nimport { AuthContext } from '../contexts';\r\n\r\nimport Container from 'react-bootstrap/Container';\r\n\r\nimport CASSelector from '../components/Selectors/CASSelector';\r\nimport TableViewer from '../components/TableViewer/TableViewer';\r\nimport Loading from '../components/Loading';\r\n\r\nfunction CAS() {\r\n    const { authInfo, setAuthInfo } = useContext(AuthContext);\r\n    const [selection, setSelection] = useState({ library: null, table: null });\r\n    const [tableData, setTableData] = useState({ rows: [], columns: [] });\r\n    const [loading, setLoading] = useState(false);\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === false) {\r\n            history.push(\"/logon\");\r\n        }\r\n    },[authInfo.authenticated, history]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.authenticated === true && !(\"cas\" in authInfo.session) ) {\r\n            const endpoint = '/cas-shared-default-http/cas/sessions';\r\n            Instance.post(endpoint)\r\n                .then(response => {\r\n                    setAuthInfo({ ...authInfo, session: { ...authInfo.session, cas: response.data.session }});\r\n                })\r\n        }\r\n    }, [authInfo, setAuthInfo]);\r\n\r\n    useEffect(() => {\r\n        if (authInfo.session.cas !== \"\" && selection.table !== null) {\r\n            const endpoint = `/cas-shared-default-http/cas/sessions/${authInfo.session.cas}/actions/table.fetch`;\r\n            const data = {\r\n                \"table\":{\r\n                    \"caslib\":selection.library,\r\n                    \"name\":selection.table\r\n                }\r\n            }\r\n            const headers = {\r\n                \"accept\": \"application/json\",\r\n                \"content-type\": \"application/json\"\r\n            };\r\n            Instance.post(endpoint, data,{headers: headers} )\r\n                .then(response => {\r\n                    if (response.data.results.Fetch.schema.length > 0) {\r\n                        const result = response.data.results.Fetch;\r\n                        setTableData({ rows: result.rows, columns: result.schema });\r\n                    }\r\n                });\r\n        }\r\n    }, [selection, authInfo.session]);\r\n\r\n    const handleSelection = (event) => {\r\n        event.preventDefault();\r\n        setTableData({ rows: [], columns: [] });\r\n        setLoading(true);\r\n        const selection = { library: event.target[0].value, table: event.target[1].value };\r\n        setSelection(selection);\r\n    };\r\n\r\n    return (\r\n        <Container className=\"justify-content-md-center\">\r\n            <CASSelector onSelect={handleSelection}/>\r\n            {tableData.rows.length !== tableData.columns.length ? <TableViewer data={tableData} /> : <Loading status={loading} />}\r\n        </Container>\r\n    )\r\n};\r\n\r\nexport default CAS;"],"mappings":"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"},"metadata":{},"sourceType":"module"}