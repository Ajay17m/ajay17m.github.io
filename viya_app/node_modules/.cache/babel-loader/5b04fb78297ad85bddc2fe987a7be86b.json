{"ast":null,"code":"import _objectSpread from\"C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from'react';import{useHistory}from'react-router-dom';import Instance from'../apis/Instance';import{AuthContext}from'../contexts';import Container from'react-bootstrap/Container';import Alert from'react-bootstrap/Alert';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import Col from'react-bootstrap/Col';import Row from'react-bootstrap/Row';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Logon(){var _useContext=useContext(AuthContext),authInfo=_useContext.authInfo,setAuthInfo=_useContext.setAuthInfo;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),alert=_useState2[0],setAlert=_useState2[1];var history=useHistory();var userInput=/*#__PURE__*/React.createRef();var passwordInput=/*#__PURE__*/React.createRef();var authenticate=function authenticate(event){event.preventDefault();setAlert('');var endpoint=\"/SASLogon/oauth/token\";var user=userInput.current.value;var password=passwordInput.current.value;var data={grant_type:\"password\",response_type:\"bearer\",username:user,password:password};var headers={'Authorization':\"Basic \"+btoa('viya_app:Orion123'),'Content-Type':'application/x-www-form-urlencoded'};Instance.post(endpoint,new URLSearchParams(data),{headers:headers}).then(function(response){if(response.status===200){Instance.defaults.headers.common['Authorization']=\"\".concat(response.data.token_type,\" \").concat(response.data.access_token);setAuthInfo(_objectSpread(_objectSpread({},authInfo),{},{authenticated:true,user:user,tokenInfo:response.data}));history.goBack();return null;}}).catch(function(error){Instance.defaults.headers.common['Authorization']=null;setAlert(\"User \".concat(user,\" could not be authenticated, please check user name and password!\"));});};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Form,{onSubmit:authenticate,children:/*#__PURE__*/_jsxs(Form.Row,{className:\"justify-content-md-center\",children:[/*#__PURE__*/_jsx(Col,{className:\"col-4\",children:/*#__PURE__*/_jsx(Form.Control,{ref:userInput,type:\"input\",placeholder:\"Login\"})}),/*#__PURE__*/_jsx(Col,{className:\"col-4\",children:/*#__PURE__*/_jsx(Form.Control,{ref:passwordInput,type:\"password\",placeholder:\"Password\"})}),/*#__PURE__*/_jsx(Col,{className:\"col-1\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Logon\"})})]})}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-md-center p-3\",children:/*#__PURE__*/_jsx(Col,{md:\"{{span:10}}\",children:alert.length>0?/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:alert}):null})})]});}export default Logon;","map":{"version":3,"names":["React","useContext","useState","useHistory","Instance","AuthContext","Container","Alert","Form","Button","Col","Row","Logon","authInfo","setAuthInfo","alert","setAlert","history","userInput","createRef","passwordInput","authenticate","event","preventDefault","endpoint","user","current","value","password","data","grant_type","response_type","username","headers","btoa","post","URLSearchParams","then","response","status","defaults","common","token_type","access_token","authenticated","tokenInfo","goBack","catch","error","length"],"sources":["C:/Users/sinajp/OneDrive - SAS/Documents/GitHub/ajay17m.github.io-1/viya_app/src/pages/Logon.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nimport Instance from '../apis/Instance';\r\n\r\nimport { AuthContext } from '../contexts';\r\n\r\nimport Container from 'react-bootstrap/Container';\r\nimport Alert from 'react-bootstrap/Alert';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\n\r\nfunction Logon() {\r\n    const { authInfo, setAuthInfo } = useContext(AuthContext);\r\n    const [alert, setAlert] = useState('');\r\n    const history = useHistory();\r\n    let userInput = React.createRef();\r\n    let passwordInput = React.createRef();\r\n\r\n    const authenticate = (event) => {\r\n        event.preventDefault();\r\n        setAlert('');\r\n        const endpoint = \"/SASLogon/oauth/token\";\r\n        const user = userInput.current.value;\r\n        const password = passwordInput.current.value;\r\n        const data = {\r\n            grant_type: \"password\",\r\n            response_type: \"bearer\",\r\n            username: user,\r\n            password: password\r\n        };\r\n\r\n        const headers = {\r\n            'Authorization': \"Basic \" + btoa('viya_app:Orion123'),\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n        };\r\n\r\n        Instance.post(endpoint, new URLSearchParams(data), { headers: headers })\r\n            .then(response => {\r\n                if (response.status === 200) {\r\n                    Instance.defaults.headers.common['Authorization'] = `${response.data.token_type} ${response.data.access_token}`;\r\n                    setAuthInfo({ ...authInfo, authenticated: true, user: user, tokenInfo: response.data });\r\n                    history.goBack();\r\n                    return null;\r\n                }\r\n            }).catch(error => {\r\n                Instance.defaults.headers.common['Authorization'] = null;\r\n                setAlert(`User ${user} could not be authenticated, please check user name and password!`);\r\n            });\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <Form onSubmit={authenticate}>\r\n                <Form.Row className='justify-content-md-center'>\r\n                    <Col className='col-4'>\r\n                        <Form.Control ref={userInput} type=\"input\" placeholder=\"Login\" />\r\n                    </Col>\r\n                    <Col className=\"col-4\">\r\n                        <Form.Control ref={passwordInput} type=\"password\" placeholder=\"Password\" />\r\n                    </Col>\r\n                    <Col className=\"col-1\">\r\n                        <Button variant=\"primary\" type=\"submit\">Logon</Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n            <Row className=\"justify-content-md-center p-3\">\r\n                <Col md='{{span:10}}'>\r\n                    {alert.length > 0 ? <Alert variant='danger'>{alert}</Alert> : null}\r\n                </Col>\r\n            </Row>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Logon;"],"mappings":"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"},"metadata":{},"sourceType":"module"}